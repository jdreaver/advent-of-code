fn main() {
    let input = parse_input(INPUT);

    let (part1_pos_x, part1_pos_depth) = part1_position(&input);
    println!("part1: {}", part1_pos_x * part1_pos_depth);

    let (part2_pos_x, part2_pos_depth) = part2_position(&input);
    println!("part2: {}", part2_pos_x * part2_pos_depth);
}

fn part1_position(instructions: &[Instruction]) -> (u32, u32) {
    let mut horizontal = 0;
    let mut depth = 0;

    for instruction in instructions {
        match instruction {
            Instruction::Forward(x) => horizontal += x,
            Instruction::Down(x) => depth += x,
            Instruction::Up(x) => depth -= x,
        }
    }

    (horizontal, depth)
}

fn part2_position(instructions: &[Instruction]) -> (u32, u32) {
    let mut horizontal = 0;
    let mut aim = 0;
    let mut depth = 0;

    for instruction in instructions {
        match instruction {
            Instruction::Forward(x) => {
                horizontal += x;
                depth += aim * x;
            }
            Instruction::Down(x) => aim += x,
            Instruction::Up(x) => aim -= x,
        }
    }

    (horizontal, depth)
}

#[derive(Debug)]
enum Instruction {
    Forward(u32),
    Down(u32),
    Up(u32),
}

fn parse_input(input: &str) -> Vec<Instruction> {
    input
        .lines()
        .map(|line| match line.split_once(" ").expect("no space") {
            ("forward", x) => Instruction::Forward(x.parse().expect("forward number")),
            ("down", x) => Instruction::Down(x.parse().expect("down number")),
            ("up", x) => Instruction::Up(x.parse().expect("up number")),
            _ => panic!("unknown instruction {}", line),
        })
        .collect()
}

const _EXAMPLE: &str = "forward 5
down 5
forward 8
up 3
down 8
forward 2";

const INPUT: &str = "forward 6
down 2
forward 2
down 8
forward 3
down 6
down 8
down 9
forward 7
forward 8
down 9
down 8
down 9
up 8
forward 1
down 7
down 3
forward 3
forward 1
down 3
forward 3
forward 1
up 8
down 5
down 1
forward 6
forward 2
up 9
down 3
down 8
down 3
down 3
up 2
down 7
down 3
up 5
forward 4
down 9
forward 6
forward 3
forward 1
forward 3
down 2
up 9
down 4
forward 6
down 3
forward 2
down 2
up 5
up 1
forward 3
forward 6
down 6
forward 7
forward 1
down 3
down 8
forward 2
down 7
up 1
up 2
forward 5
down 8
down 8
forward 9
forward 7
forward 2
forward 7
up 6
up 9
down 4
forward 4
forward 4
up 1
down 7
forward 9
forward 3
down 6
down 9
forward 7
forward 4
up 7
up 6
up 8
down 9
forward 1
down 1
forward 8
down 7
forward 5
down 3
down 3
down 8
down 8
down 4
up 4
forward 3
down 8
down 9
up 3
up 8
down 9
up 5
forward 2
forward 5
forward 5
down 8
forward 9
forward 8
down 5
down 9
forward 6
forward 2
forward 3
up 1
forward 1
up 2
up 2
forward 4
forward 8
forward 5
down 1
up 4
forward 5
up 7
down 5
down 5
forward 8
up 2
down 7
down 6
down 5
down 5
down 1
down 8
forward 9
forward 2
up 6
up 4
down 8
forward 1
forward 2
down 2
forward 7
forward 7
forward 3
forward 6
forward 8
down 3
forward 6
up 5
down 3
down 8
up 1
forward 1
down 7
down 3
up 5
forward 6
forward 8
forward 9
up 5
up 5
up 5
forward 8
up 5
down 6
down 7
down 5
up 7
up 1
up 3
forward 8
up 9
down 7
down 4
up 6
up 8
up 9
up 9
forward 5
up 5
forward 2
forward 2
forward 6
up 2
down 8
up 2
forward 5
down 9
up 7
down 9
forward 1
forward 8
up 1
forward 7
forward 2
down 3
forward 3
forward 2
up 9
forward 4
forward 9
down 9
forward 5
forward 1
forward 5
forward 8
up 5
forward 1
down 4
up 8
up 4
up 7
forward 4
down 1
up 6
forward 6
down 2
down 7
forward 4
up 7
forward 7
forward 9
down 5
up 5
forward 4
down 6
forward 1
up 8
up 8
down 8
down 7
forward 7
down 3
forward 7
down 3
down 5
down 4
up 8
down 2
down 2
up 5
forward 9
up 9
forward 2
up 4
forward 4
down 2
down 7
forward 7
down 1
down 6
down 4
forward 6
up 4
forward 4
down 6
down 8
down 3
forward 7
down 3
forward 7
down 7
forward 4
up 9
down 5
forward 7
forward 7
up 6
down 3
forward 9
down 1
forward 4
up 9
down 3
up 9
down 5
up 6
forward 1
forward 9
up 4
down 3
forward 1
down 7
down 2
forward 2
down 6
up 4
down 4
up 9
down 3
down 9
down 4
down 1
up 8
down 2
up 1
forward 5
forward 9
forward 1
up 4
forward 5
down 7
up 6
down 3
forward 8
down 1
down 5
forward 5
down 5
down 7
down 8
down 7
up 6
forward 8
down 8
forward 6
down 6
down 7
down 3
forward 2
down 6
down 8
down 7
down 3
up 1
down 7
forward 8
forward 2
forward 5
down 4
up 4
forward 9
down 9
forward 6
down 7
down 4
down 8
up 9
forward 7
down 4
forward 7
forward 1
forward 7
down 9
down 7
forward 3
forward 3
forward 2
down 5
up 5
forward 5
down 2
forward 7
forward 9
forward 7
down 7
down 9
down 5
forward 2
up 5
down 3
forward 7
down 4
down 3
up 5
down 6
down 3
up 4
forward 3
down 1
forward 6
forward 6
down 8
forward 9
down 2
up 3
down 4
down 5
forward 3
down 9
forward 2
up 3
up 4
forward 9
down 2
forward 9
forward 3
down 4
down 2
down 5
down 4
forward 4
down 1
down 9
down 2
forward 8
down 5
forward 5
up 7
down 5
down 2
forward 5
up 4
down 5
up 3
forward 7
down 9
forward 5
forward 2
forward 1
down 7
down 9
down 2
up 2
up 2
up 4
down 4
down 7
down 3
forward 5
forward 3
up 6
down 6
up 6
up 9
forward 8
forward 4
up 3
forward 1
forward 2
up 5
forward 5
forward 8
forward 7
forward 4
down 1
down 8
down 1
forward 3
up 1
forward 7
forward 4
down 8
forward 7
forward 9
forward 3
down 9
down 9
down 3
up 6
up 1
down 4
forward 5
forward 4
forward 6
forward 8
down 6
down 3
forward 5
forward 6
down 4
down 2
up 3
down 3
down 7
down 5
down 5
forward 6
down 4
forward 1
up 2
forward 3
down 1
down 4
down 9
down 7
down 9
forward 9
down 6
down 3
down 2
down 5
up 8
forward 5
forward 5
forward 4
up 5
forward 1
down 9
down 1
up 5
forward 8
forward 6
forward 5
down 1
up 5
down 8
up 7
down 8
down 2
down 3
forward 2
up 4
down 6
up 6
down 3
down 7
up 3
forward 4
down 3
forward 4
up 9
forward 5
down 2
forward 7
forward 5
up 3
up 2
forward 2
down 8
down 1
down 3
up 5
down 4
forward 4
down 1
forward 9
down 3
down 7
down 4
down 4
forward 7
up 5
forward 4
down 8
up 4
forward 6
down 1
up 4
forward 4
down 6
up 5
up 1
forward 2
down 5
forward 8
forward 6
down 8
down 7
down 7
down 1
forward 5
forward 7
forward 7
forward 7
up 3
forward 9
forward 1
down 9
forward 4
up 8
forward 1
forward 5
forward 4
down 2
forward 4
forward 9
forward 3
down 1
forward 4
forward 9
forward 5
down 5
down 5
forward 7
down 3
forward 4
down 6
forward 7
down 2
down 1
down 5
forward 4
forward 9
down 4
forward 2
down 8
up 5
down 9
forward 8
down 3
up 6
down 2
down 4
forward 4
up 2
down 4
down 4
up 7
down 6
forward 4
down 7
forward 3
down 1
up 1
down 2
down 6
down 4
up 3
down 6
up 2
down 6
forward 3
down 9
forward 5
down 5
down 9
down 9
down 7
forward 9
forward 8
forward 9
up 9
forward 7
forward 4
forward 4
up 5
forward 2
down 1
up 9
forward 2
forward 7
forward 1
down 9
forward 9
up 8
up 1
up 7
up 7
down 5
forward 2
forward 8
forward 6
down 7
forward 1
down 9
down 4
down 4
down 1
up 7
forward 4
forward 6
up 5
forward 2
down 9
down 7
forward 1
forward 2
down 5
forward 3
forward 8
forward 6
forward 3
forward 2
down 1
forward 1
forward 1
forward 3
down 9
up 9
down 9
down 6
forward 7
down 6
forward 9
down 9
down 7
down 1
down 9
up 9
down 6
forward 9
down 6
forward 3
down 8
up 5
forward 5
forward 8
up 3
down 8
up 6
forward 4
down 2
forward 6
down 9
forward 6
forward 4
forward 9
forward 3
down 2
down 4
forward 5
down 9
up 7
forward 4
up 1
forward 1
down 6
forward 3
forward 7
forward 2
forward 2
down 5
down 9
down 3
down 5
up 3
forward 1
down 2
down 4
down 1
up 9
up 5
up 1
down 1
up 9
down 5
up 3
up 3
down 7
forward 4
down 6
forward 2
forward 7
forward 4
down 2
forward 6
forward 2
down 3
up 3
up 9
forward 9
forward 9
forward 6
down 8
down 1
forward 9
up 1
down 6
forward 6
up 5
forward 2
forward 6
down 9
forward 1
forward 8
down 8
forward 4
forward 7
up 6
up 1
forward 7
forward 3
forward 2
down 4
down 7
down 7
down 1
down 6
forward 1
down 9
up 9
up 9
down 2
down 2
forward 5
up 2
forward 7
up 5
down 9
forward 7
forward 2
down 8
up 1
down 5
forward 6
down 8
down 7
forward 4
up 2
down 8
forward 2
down 5
down 4
down 9
down 1
down 9
down 6
down 3
forward 1
forward 6
up 1
up 1
up 9
down 2
down 2
forward 5
down 3
forward 4
down 3
down 7
down 7
forward 4
up 3
forward 4
down 3
forward 8
forward 1
up 2
up 1
forward 1
down 6
down 1
down 3
forward 7
down 7
forward 4
forward 5
forward 3
down 5
forward 9
forward 5
down 7
forward 6
down 4
down 4
down 9
down 3
up 9
forward 7
down 7
forward 6
down 2
down 9
forward 4
forward 1
forward 4
down 5
forward 7
down 9
down 8
forward 9
forward 1
down 9
forward 6
up 5
forward 9
down 1
down 5
forward 4
forward 5
forward 8
down 5
forward 9
down 6
down 2
up 4
up 8
forward 3
forward 4
down 3
forward 4
up 6
forward 3
forward 8
forward 7
down 1
down 9
down 8
down 8
down 1
forward 9
up 4
down 5
forward 7
down 8
down 3
forward 9
down 5
forward 7
forward 2
down 4
forward 2
forward 7
down 6
forward 7
down 2
forward 9
down 9
forward 8
forward 8
down 6
forward 7
down 8
forward 7
forward 3
down 1
up 8
down 5
down 6
up 5
forward 5
forward 5
up 5
up 3
up 7
down 6
forward 8
forward 4
down 2
up 5
forward 8
down 6
forward 4
forward 2
up 8
down 8
down 5
down 4
forward 9
forward 9
forward 6
forward 6
down 3
up 1
down 4
down 8
down 9
down 1
forward 3
forward 1
down 9
down 3
down 7
forward 6
forward 9
down 8
down 8
forward 6
forward 1
down 3
forward 1
down 8
down 3
down 9
up 1
forward 6
up 2
down 3
forward 4
forward 2
up 2
down 5
forward 1
down 3
forward 9
forward 4
forward 6
down 3
forward 7
down 6
up 3
up 7
up 5
down 4
forward 4
up 1
forward 7
up 9
forward 3
up 1
down 3
down 4
forward 4
up 3
down 6
down 9
down 6
forward 4
down 9
down 6
forward 4
forward 3
down 3
up 7
down 9
forward 8";
